{% extends 'base.html' %}
{% load static %}

{% block title %}Create Notebook - Workspace{% endblock %}

{% block body_class %}bg-gradient-aurora{% endblock %}

{% block extra_css %}
<style>
  /* Color Picker Radio Buttons */
  .color-picker-container {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1rem;
  }
  
  .color-option {
    position: relative;
  }
  
  .color-option input[type="radio"] {
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
  }
  
  .color-option label {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.05);
    border: 2px solid rgba(255, 255, 255, 0.1);
    border-radius: 0.75rem;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  
  .color-option label:hover {
    background: rgba(255, 255, 255, 0.08);
    border-color: rgba(255, 255, 255, 0.2);
    transform: translateY(-2px);
  }
  
  .color-swatch {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    border: 3px solid rgba(255, 255, 255, 0.2);
    transition: all 0.3s ease;
  }
  
  .color-option input[type="radio"]:checked + label {
    background: rgba(255, 255, 255, 0.1);
    border-color: var(--aurora-cyan);
    box-shadow: 0 0 20px rgba(6, 182, 212, 0.3);
  }
  
  .color-option input[type="radio"]:checked + label .color-swatch {
    border-color: white;
    box-shadow: 0 0 15px currentColor;
    transform: scale(1.1);
  }
  
  .color-name {
    color: white;
    font-size: 0.875rem;
    font-weight: 500;
  }
  
  /* Checkbox Aurora */
  .checkbox-container {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.05);
    border: 2px solid rgba(255, 255, 255, 0.1);
    border-radius: 0.75rem;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  
  .checkbox-container:hover {
    background: rgba(255, 255, 255, 0.08);
    border-color: rgba(255, 255, 255, 0.2);
  }
  
  .checkbox-container input[type="checkbox"] {
    width: 24px;
    height: 24px;
    cursor: pointer;
    accent-color: var(--aurora-cyan);
  }
  
  .checkbox-label {
    color: white;
    font-size: 1rem;
    font-weight: 500;
    cursor: pointer;
    user-select: none;
  }
  
  /* Form animations */
  .form-section {
    animation: fadeInUp 0.5s ease;
  }
  
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>
{% endblock %}

{% block nav_links %}
  <a href="{% url 'home' %}" class="text-white hover:text-aurora-cyan transition-colors font-medium">Home</a>
  <a href="{% url 'workspace:home' %}" class="text-white hover:text-aurora-cyan transition-colors font-medium">Workspace</a>
  <span class="text-white/40">‚Ä¢</span>
  <span class="text-aurora-cyan font-medium">New Notebook</span>
{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto px-6 py-8">
  <!-- Header -->
  <div class="text-center mb-8 form-section">
    <div class="text-6xl mb-4">{% if is_edit %}‚úèÔ∏èüìì{% else %}üìì‚ú®{% endif %}</div>
    <h1 class="text-5xl font-bold text-white mb-3">
      {% if is_edit %}
        Edit <span class="text-aurora">Notebook</span>
      {% else %}
        Create a New <span class="text-aurora">Notebook</span>
      {% endif %}
    </h1>
    <p class="text-white/70 text-lg">
      {% if is_edit %}
        Update your notebook details
      {% else %}
        Start organizing your learning journey with a personalized notebook
      {% endif %}
    </p>
  </div>

  <!-- Form -->
  <form method="post" class="space-y-8">
    {% csrf_token %}
    
    <!-- Title -->
    <div class="form-section card-aurora" style="animation-delay: 0.1s">
      <label class="block text-white text-lg font-semibold mb-3">
        <span class="flex items-center gap-2">
          <svg class="w-5 h-5 text-aurora-cyan" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"/>
          </svg>
          Notebook Title <span class="text-red-400">*</span>
        </span>
      </label>
      {{ form.title }}
      {% if form.title.errors %}
        <p class="text-red-400 text-sm mt-2">{{ form.title.errors.0 }}</p>
      {% endif %}
      <p class="text-white/50 text-sm mt-2">
        Give your notebook a clear, descriptive name
      </p>
    </div>

    <!-- Description -->
    <div class="form-section card-aurora" style="animation-delay: 0.2s">
      <label class="block text-white text-lg font-semibold mb-3">
        <span class="flex items-center gap-2">
          <svg class="w-5 h-5 text-aurora-cyan" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
          </svg>
          Description <span class="text-white/40 text-sm font-normal">(optional)</span>
        </span>
      </label>
      {{ form.description }}
      {% if form.description.errors %}
        <p class="text-red-400 text-sm mt-2">{{ form.description.errors.0 }}</p>
      {% endif %}
      <p class="text-white/50 text-sm mt-2">
        What topics or subjects will this notebook cover?
      </p>
    </div>

    <!-- Color Picker -->
    <div class="form-section card-aurora" style="animation-delay: 0.3s">
      <label class="block text-white text-lg font-semibold mb-4">
        <span class="flex items-center gap-2">
          <svg class="w-5 h-5 text-aurora-cyan" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"/>
          </svg>
          Choose a Color
        </span>
      </label>
      <div class="color-picker-container">
        {% for value, label in form.fields.color.choices %}
          <div class="color-option">
            <input type="radio" id="color_{{ forloop.counter }}" name="color" value="{{ value }}" 
                   {% if forloop.first %}checked{% endif %}>
            <label for="color_{{ forloop.counter }}">
              <div class="color-swatch" style="background-color: {{ value }};"></div>
              <span class="color-name">{{ label }}</span>
            </label>
          </div>
        {% endfor %}
      </div>
      {% if form.color.errors %}
        <p class="text-red-400 text-sm mt-3">{{ form.color.errors.0 }}</p>
      {% endif %}
      <p class="text-white/50 text-sm mt-4">
        Pick a color to help you quickly identify this notebook
      </p>
    </div>

    <!-- Favorite -->
    <div class="form-section card-aurora" style="animation-delay: 0.4s">
      <label class="checkbox-container">
        {{ form.is_favorite }}
        <span class="checkbox-label flex items-center gap-2">
          <span>‚≠ê</span>
          <span>Mark as Favorite</span>
        </span>
      </label>
      {% if form.is_favorite.errors %}
        <p class="text-red-400 text-sm mt-2">{{ form.is_favorite.errors.0 }}</p>
      {% endif %}
      <p class="text-white/50 text-sm mt-3">
        Favorite notebooks appear first in your workspace
      </p>
    </div>

    <!-- Actions -->
    <div class="flex items-center justify-between gap-4 form-section" style="animation-delay: 0.5s">
      <a href="{% if is_edit %}{% url 'workspace:notebook_detail' notebook.id %}{% else %}{% url 'workspace:home' %}{% endif %}" class="btn-secondary inline-flex items-center space-x-2">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
        </svg>
        <span>Cancel</span>
      </a>
      
      <button type="submit" class="btn-primary btn-lg inline-flex items-center space-x-2">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
        </svg>
        <span>{% if is_edit %}Update Notebook{% else %}Create Notebook{% endif %}</span>
      </button>
    </div>
  </form>
</div>
{% endblock %}

{% block notifications %}
  {% if messages %}
    <div class="notification-container">
      {% for message in messages %}
        <div class="notification notification-{{ message.tags|default:'info' }}">
          <div class="notification-icon"></div>
          <div class="notification-content">
            <div class="notification-title">
              {% if message.tags == 'success' %}Success!{% elif message.tags == 'error' %}Error!{% elif message.tags == 'warning' %}Warning{% else %}Information{% endif %}
            </div>
            <div class="notification-message">{{ message }}</div>
          </div>
          <div class="notification-progress"></div>
        </div>
      {% endfor %}
    </div>
  {% endif %}
{% endblock %}
